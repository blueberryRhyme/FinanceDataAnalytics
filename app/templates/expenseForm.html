{% extends "base.html" %}

{% block title %}Log Expense{% endblock %}

{% block head %}
<!-- No additional styles needed here as they're now in main.css -->
<style>
  /* Expense form specific styles that aren't in main.css */
  #other-category-container {
    display: none;
    margin-top: 0;
    margin-bottom: 20px;
  }
</style>
{% endblock %}


{% block content %}
<div class="page-container">
  <h1>Log Your Expense</h1>

  <div class="card">
    <form id="expense-form" class="form-wrapper" method="POST" action="{{ url_for('main.expenseForm') }} " enctype="multipart/form-data">
      {{ form.csrf_token }}

      <label for="amount">{{ form.amount.label }}</label>
      {{ form.amount(class="input-box", placeholder="Enter amount") }}

      <label for="category">{{ form.category.label }}</label>
      {{ form.category(class="input-box") }}

      <div id="other-category-container">
        <label for="other_category">{{ form.other_category.label }}</label>
        {{ form.other_category(class="input-box", placeholder="Specify category") }}
      </div>

      <label for="date">{{ form.date.label }}</label>
      {{ form.date(class="input-box") }}

      {{ form.submit(class="button") }}

      <label for="csv_file">Or upload CSV of expenses</label>
      <input type="file" name="csv_file"
             accept=".csv"
             class="input-box"/>

             
    </form>
  </div>
</div>


  <script>
    // show/hide "other" box
    const cat = document.getElementById('category');
    const otherDiv = document.getElementById('other-category-container');
    cat.addEventListener('change', () => {
      otherDiv.style.display = cat.value === 'other' ? 'block' : 'none';
    });

    // Initialize date field to today's date if not already set
    window.addEventListener('DOMContentLoaded', () => {
      const dateField = document.getElementById('date');
      if (!dateField.value) {
        const today = new Date();
        const yyyy = today.getFullYear();
        let mm = today.getMonth() + 1;
        let dd = today.getDate();
        
        if (dd < 10) dd = '0' + dd;
        if (mm < 10) mm = '0' + mm;
        
        dateField.value = yyyy + '-' + mm + '-' + dd;
      }
    });
  </script>
  
{% endblock %}
